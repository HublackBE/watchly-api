generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
}

model users {
  id                 Int                       @id @default(autoincrement())
  name               String                    @unique(map: "users_name_unique")
  slug               String?                   @unique(map: "users_slug_unique")
  email              String                    @unique(map: "users_email_unique")
  email_verified_at  DateTime?
  password           String
  bio                String?
  is_admin           Boolean?                  @default(false)
  avatar_path        String?
  date_of_birth      DateTime?
  remember_token     String?
  created_at         DateTime?
  updated_at         DateTime?
  comments           comments[]
  favourite_movies   favourite_movies[]
  favourite_tv_shows favourite_tv_shows[]
  movies             movies[]
  platforms          platforms[]
  tv_shows           tv_shows[]
}

model movies {
  id               Int                @id @default(autoincrement())
  title            String
  slug             String             @unique(map: "movies_slug_unique")
  description      String?
  release_date     DateTime?
  director         String?
  genre            Genre?
  rating           Float?
  poster_path      String?
  imdb_id          String?
  added_by         Int
  created_at       DateTime?
  updated_at       DateTime?
  favourite_movies favourite_movies[]
  movie_platform   movie_platform[]
  users            users              @relation(fields: [added_by], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model platforms {
  id               Int                @id @default(autoincrement())
  name             String
  slug             String             @unique(map: "platforms_slug_unique")
  url              String?
  url_template     String?
  added_by         Int
  created_at       DateTime?
  updated_at       DateTime?
  movie_platform   movie_platform[]
  platform_tv_show platform_tv_show[]
  users            users              @relation(fields: [added_by], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model movie_platform {
  id          Int       @id @default(autoincrement())
  movie_id    Int
  platform_id Int
  external_id String?
  url         String?
  created_at  DateTime?
  updated_at  DateTime?
  platforms   platforms @relation(fields: [platform_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  movies      movies    @relation(fields: [movie_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([movie_id, platform_id], map: "movie_platform_movie_id_platform_id_unique")
}


model comments {
  id               Int       @id @default(autoincrement())
  content          String
  user_id          Int
  commentable_type String
  commentable_id   Int
  created_at       DateTime?
  updated_at       DateTime?
  users            users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([commentable_type, commentable_id], map: "comments_commentable_type_commentable_id_index")
}

model faqs {
  id         Int       @id @default(autoincrement())
  question   String
  answer     String
  created_at DateTime?
  updated_at DateTime?
}

model favourite_movies {
  id         Int       @id @default(autoincrement())
  user_id    Int
  movie_id   Int
  created_at DateTime?
  updated_at DateTime?
  movies     movies    @relation(fields: [movie_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users      users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, movie_id], map: "favourite_movies_user_id_movie_id_unique")
}

model favourite_tv_shows {
  id         Int       @id @default(autoincrement())
  user_id    Int
  tv_show_id Int
  created_at DateTime?
  updated_at DateTime?
  tv_shows   tv_shows  @relation(fields: [tv_show_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users      users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, tv_show_id], map: "favourite_tv_shows_user_id_tv_show_id_unique")
}

model platform_tv_show {
  id          Int       @id @default(autoincrement())
  tv_show_id  Int
  platform_id Int
  external_id String?
  url         String?
  created_at  DateTime?
  updated_at  DateTime?
  platforms   platforms @relation(fields: [platform_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tv_shows    tv_shows  @relation(fields: [tv_show_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([tv_show_id, platform_id], map: "platform_tv_show_tv_show_id_platform_id_unique")
}

model tv_shows {
  id                 Int                  @id @default(autoincrement())
  title              String
  slug               String               @unique(map: "tv_shows_slug_unique")
  description        String?
  release_date       DateTime?
  director           String?
  genre              String?
  rating             Float?
  poster_path        String?
  imdb_id            String?
  added_by           Int
  created_at         DateTime?
  updated_at         DateTime?
  favourite_tv_shows favourite_tv_shows[]
  platform_tv_show   platform_tv_show[]
  users              users                @relation(fields: [added_by], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

enum Genre {
  ACTION
  COMEDY
  DRAMA
  HORROR
  ROMANCE
  SCI_FI
  THRILLER
  FANTASY
  DOCUMENTARY
  ANIMATION
}
